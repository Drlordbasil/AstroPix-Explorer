Thank you for the enhancements. Here's a summary of the changes I made:

1. Separated the code into different modules for better organization and maintainability.
2. Added error handling with try-except blocks and logging for better error reporting.
3. Replaced string concatenation with f-strings for better readability.
4. Used the logging module instead of print statements for logging.
5. Utilized context managers to automatically handle file operations.
6. Refactored media type checking using a dictionary mapping.
7. Simplified code using list comprehension.
8. Removed unnecessary statements, variables, and imports.

I hope you find these enhancements helpful. Let me know if you have any further questions or need additional assistance.